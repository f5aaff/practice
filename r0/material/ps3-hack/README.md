# Hacking PS3 Signatures

#### Requirements

- [python3](https://www.python.org/)
- [pycryptodome](https://github.com/Legrandin/pycryptodome)

#### Exercise

You extracted the following DSA domain parameters `(p,q,g)`, SHA1 fingerprints
`h1` and `h2`, DSA public key `y`, and DSA signatures `sig1` and `sig2` from the
PS3 games `Portal 2` and `Minecraft`. 

```
   p = 129570736374393280360874421749656618648472895056230507103725664902467039685265288356788849348109094493485563726402962659349904985061333051347927584106018898162627556951694292795222312739690798359920737769722657952741803795552012039797121453510564475423572772582236910544520714904123340454784221062180709970371
   q = 1049360825264211318919220172670632636101903709629
   g = 115271934155295135967017909883784743167921300687769147296561968554660095228818489111498338589055264694190233000831197774939357720436009350571413008316803869484747366634215788435542329479130266563635296047274272220155181263794719961032703028461664072190159357343034020368421893402721143616035668517846131507129
   y = 121258457743941400017236408162630895783227751147611045135427815590252004983819844481736214426794666857474074374577049730922004542469318392991434398700397904454512515188311373104852172276087658951677054863935090862409801461444587938565672574556260754384066265473847790319862679840743747348694368093320301550883
  h1 = 342333396831744928439207551062789552955421505219
sig1 = (51548221150354323901248948200600122077764868202, 1006447649006919706259415719640254162540733497225)
  h2 = 1377325407270520690954972820750612362610474480861
sig2 = (51548221150354323901248948200600122077764868202, 662361006561249566325910578250119038019330726281)
```

The signatures were generated with the same secret nonce `k`. Recover `k` and
the private key `x` that belongs to `y`.

#### Tips

- Check the file `dsa.py` to see how PS3 binaries are signed. 
- You can use the `pow` Python3 function to verify that you recovered the correct `x`.
- To solve this exercise you need an implementation of the Extended
  Euclidean Algorithm (see `util.py`). You get **bonus points** if you
  implement it yourself!
